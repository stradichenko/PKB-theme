{{/* Define shared CSS files list */}}
{{ $coreCSS := slice
    "css/global/variables/core.css"
    "css/global/variables/typography.css"
    "css/global/variables/layout.css"
    "css/global/variables/components.css"
    "css/global/reset.css"
    "css/body.css"
    "css/header.css"
    "css/footer.css"
    "css/sidenotes.css"
    "css/components/toc.css"
    "css/components/table.css"
    "css/components/blockquote.css"
    "css/components/citation.css"
    "css/components/code.css"
    "css/components/markdown.css"
    "css/components/knowledge-graph.css"
    "css/components/lda-analysis.css"
    "css/components/pdf-button.css"
    "css/components/tts-button.css"
    "css/components/mermaid-diagram.css"
    "css/list.css"
    "css/filters.css"
    "css/components/recent-posts-grid.css"
    "css/about-profile.css"
    "css/portfolio.css"
    "css/main.css"
}}

{{ if eq hugo.Environment "development" }}
  <!-- Development mode: load individual files with fingerprinting -->
  {{ range $coreCSS }}
    {{ with resources.Get . }}
      {{ $css := . | fingerprint }}
      <link rel="stylesheet" href="{{ $css.RelPermalink }}" integrity="{{ $css.Data.Integrity }}" crossorigin="anonymous">
    {{ end }}
  {{ end }}
{{ else }}
  <!-- Production mode: concat, minify, and fingerprint -->
  {{ $cssResources := slice }}
  {{ range $coreCSS }}
    {{ with resources.Get . }}
      {{ $cssResources = $cssResources | append . }}
    {{ end }}
  {{ end }}
  {{ if gt (len $cssResources) 0 }}
    {{ $combined := $cssResources | resources.Concat "css/all.css" | minify | fingerprint }}
    <link rel="stylesheet" href="{{ $combined.RelPermalink }}" integrity="{{ $combined.Data.Integrity }}" crossorigin="anonymous">
  {{ end }}
{{ end }}

<!-- Load independent styles always -->
{{ range slice
    "css/search.css"
    "css/theme-toggle.css"
    "css/contribution-calendar.css"
}}
  {{ with resources.Get . }}
    {{ $independent := . | minify | fingerprint }}
    <link rel="stylesheet" href="{{ $independent.RelPermalink }}" integrity="{{ $independent.Data.Integrity }}" crossorigin="anonymous">
  {{ end }}
{{ end }}
